function hideUnhideHandlersMobile(){$("#visible-alert,#hide-alert").off("click").click((function(){$(this).hide()})),$(".btn-hide").off("click").click((function(e){e.preventDefault();var t=$(this);$.post("/edit/hide",{id:$(this).attr("ad_id")},(function(e){$("#view").addClass("off-item"),t.popover("show"),t.hide(),t.siblings(".btn-unhide").show(),t.closest(".item-actions").find(".upgrades-message").removeClass("hide"),$("#hide-alert").length>0?($("#visible-alert").hide(),$("#hide-alert").fadeIn(300).delay(5e3).fadeOut(500)):(t.parent().parent().parent().find(".visible-alert").hide(),t.parent().parent().parent().find(".hide-alert").fadeIn(300).delay(5e3).fadeOut(500),t.parent().parent().parent().find(".view-item-img").addClass("off-item"))}),"html")})),$(".btn-unhide").off("click").click((function(e){e.preventDefault();var t=$(this);$.post("/edit/unhide",{id:$(this).attr("ad_id")},(function(e){$("#view").removeClass("off-item"),t.popover("show"),t.hide(),t.siblings(".btn-hide").show(),t.closest(".item-actions").find(".upgrades-message").addClass("hide"),$("#hide-alert").length>0?($("#hide-alert").hide(),$("#visible-alert").fadeIn(300).delay(3e3).fadeOut(500)):(t.parent().parent().parent().find(".hide-alert").hide(),t.parent().parent().parent().find(".visible-alert").fadeIn(300).delay(3e3).fadeOut(500),t.parent().parent().parent().find(".view-item-img").removeClass("off-item"))}),"html")})),$(".contacts-view-btn").on("click",(function(e){e.preventDefault();var t=$(this);window.isWhatsappClicked=!1,t.closest(".whatsapp").length&&(trackEvent({category:"Contact",event:"Whatsapp",GA:{label:"View"}},["ga"]),trackDDMetric("ad.contacted",{type:"whatsapp"}),window.isWhatsappClicked=!0),t.closest(".phone").length&&(trackEvent({category:"Contact",event:"Mobile Number",GA:{label:"View"}},["ga"]),trackDDMetric("ad.contacted",{type:"phone"})),t.closest(".website").length&&(trackEvent({category:"Contact",event:"Website",GA:{label:"View"}},["ga"]),trackDDMetric("ad.contacted",{type:"website"})),t.closest(".email").length&&(trackEvent({category:"Contact",event:"Email",GA:{label:"View"}},["ga"]),trackDDMetric("ad.contacted",{type:"email"})),loadContactsCaptcha(t)})),$(".ers_popover_reason").click((function(e){e.preventDefault();var t,i,a=$(this).attr("data-content");return t=a.match(/<span>(.*?)<\/span>/g).map((function(e){return e.replace(/<\/?span>/g,"")})),i=a.match(/href=['"](.*?)['"]/g).map((function(e){return e.replace(/href=['"]/g,"").replace(/['"]/g,"")})),openAuditDialog(t[0],i[0]),!1}))}function showAdContactsMobile(e){var t="";e.data.phone&&(e.data.whatsapp&&(t+='<a class="btn btn-white btn-tall btn-block mb whatsapp" target="_blank" href="'+e.data.whatsapp+'" itemprop="whatsapp"><i class="icon-whatsapp mr"></i><strong>'+$(".contacts-container").attr("data-text-whatsapp")+"</strong></a>"),t+='<a class="btn btn-white btn-tall btn-block mb phone" href="tel:'+e.data.phone_numeric+'" itemprop="telephone"><i class="icon-phone-o"></i><strong>'+e.data.phone+"</strong></a>"),e.data.website?t+='<a class="btn btn-white btn-tall btn-block mb website" href="'+e.data.website+'" target="_blank" rel="nofollow" itemprop="url"><i class="icon-globe2"></i><strong>'+e.data.website+"</strong></a>":t+='<meta itemprop="url" content="'+e.data.canonical_url+'" />',e.data.email&&(t+='<a class="btn btn-white btn-tall btn-block email email-contact-data" href="mailto:'+e.data.email+'" itemprop="email"><i class="icon-email-o"></i><strong>'+e.data.email+"</strong></a>"),e.data.excerpt&&$("#excerpt").html(e.data.excerpt),e.data.description&&$("#desc .ad-description-container").html(e.data.description),$(".contacts-container").html(t),$(".anti-scam-alert").length<2&&$(".container.cta").append($(".anti-scam-alert").clone().removeClass("hidden")),$(".container.cta").find("a").click((function(){var e=$(this);e.hasClass("whatsapp")&&trackEvent({category:"Contact",event:"Whatsapp",GA:{label:"Click"}},["ga"]),e.hasClass("phone")&&trackEvent({category:"Contact",event:"Mobile Number",GA:{label:"Click"}},["ga"]),e.hasClass("website")&&trackEvent({category:"Contact",event:"Website",GA:{label:"Click"}},["ga"]),e.hasClass("email")&&trackEvent({category:"Contact",event:"Email",GA:{label:"Click"}},["ga"])}))}function hideFiltersMobile(){$(".filter").removeClass("hidden"),$("#more-filters").show(),$("#adv-filters").collapse({toggle:!1}).collapse("hide")}function populateFormFiltersMobile(){if("undefined"!=typeof regionsByProvince){filters.category_id&&$("#selected_category_name").text(categories[filters.category_id].name);var e=regionsByProvince[provinceId];filters.region_id&&$("#selected_region_name").text(e[filters.region_id].name),filters.q?$("#search-q").val(filters.q):$("#search-q").val("");var t=!1;if(filters.age_from&&filters.age_from>18)var i=filters.age_from;else i="18";if(i!=$("#age_from").val()&&(t=!0),$("#age_from").val(i),filters.age_to&&filters.age_to<50)var a=filters.age_to;else a="50+";if(a!=$("#age_to").val()&&(t=!0),$("#age_to").val(a),i>18||a){var l=i;l+=a?" to "+a:"+",$("#selected_age").html("Ages <span>"+l+"</span>")}else $("#selected_age").html("All Ages <span></span>");if(t){var n=$("#age_to").parent().find(".slider-control");stopSlideWorkaround=!0,n.slider("setValue",[parseInt($("#age_from").val()),parseInt($("#age_to").val())]),stopSlideWorkaround=!1}if(filters.availability?availability=filters.availability:availability="",updateGeoFilters(availability)){if(filters.incall_dist>0||filters.geo){if($("#incall-fields").show(),$(".incall-switch label.btn-on").addClass("active"),$(".incall-switch label.btn-off").removeClass("active"),filters.incall_dist&&filters.incall_dist>0&&filters.incall_dist<=50)var r=parseInt(filters.incall_dist);else r=10;if((r+="km")!=$("#incall_dist").val()&&(t=!0),t){$("#incall_dist").val(r);n=$("#incall_dist").parent().find(".slider-control");stopSlideWorkaround=!0,n.slider("setValue",r),stopSlideWorkaround=!1}}else $("#incall-fields").hide(),$(".incall-switch label.btn-on").removeClass("active"),$(".incall-switch label.btn-off").addClass("active");filters.geo?$("#location").val(filters.geo):$("#location").val("")}for(key in $(".location-ethnicity input").prop("checked",!1),checked=!1,filters.city_code)city_code=filters.city_code[key],""!=city_code&&(checked=!0,$("#city_"+city_code).prop("checked",!0));if(checked||$("#city_0").prop("checked",!0),filters.rate_from&&filters.rate_from>25)r=filters.rate_from;else r=25;if(r!=$("#rate_from").val()&&(t=!0),$("#rate_from").val(r),filters.rate_to&&filters.rate_to<500)r=filters.rate_to;else r="500+";if(r!=$("#rate_to").val()&&(t=!0),$("#rate_to").val(r),t){n=$("#rate_to").parent().find(".slider-control");stopSlideWorkaround=!0,n.slider("setValue",[parseInt($("#rate_from").val()),parseInt($("#rate_to").val())]),stopSlideWorkaround=!1}for(key in checked=!1,filters.ethnicity_id)ethnicity_id=parseInt(filters.ethnicity_id[key]),ethnicity_id>0&&(checked=!0,$("#ethnicity_"+ethnicity_id).prop("checked",!0));for(key in checked||$("#ethnicity_0").prop("checked",!0),checked=!1,filters.service_id)service_id=parseInt(filters.service_id[key]),service_id>0&&(checked=!0,$("#service_"+service_id).prop("checked",!0));for(key in checked||$("#service_0").prop("checked",!0),$("[name*=availability]").prop("checked",!1),checked=!1,filters.availability)availability=parseInt(filters.availability[key]),availability>0&&(checked=!0,$("#availability_"+availability).prop("checked",!0));checked||$("#availability_0").prop("checked",!0),$("#photoshoot").prop("checked",1==filters.photoshoot),$("#online").prop("checked",1==filters.online),$("#verified").prop("checked",1==filters.verified),$("#has_photos").prop("checked",1==filters.has_photos),$("#has_videos").prop("checked",1==filters.has_videos),$("#has_lyla").prop("checked",1==filters.has_lyla),$("#available-now").prop("checked",1==filters.available_now),$("#inputCellNumber_01").val(""),$("#inputCellNumber_02").val(""),$("#inputCellNumber_03").val(""),filters.phone1&&$("#inputCellNumber_01").val(filters.phone1),filters.phone2&&$("#inputCellNumber_02").val(filters.phone2),filters.phone3&&$("#inputCellNumber_03").val(filters.phone3),updateEthnicities(),updateEthnicities("#mobile-city_id","#cit")}}function swipeInit(){window.mySwipe=new Swipe(document.getElementById("mySwipe"),{data:"Swipe",startSlide:"undefined"!=typeof startSlide?startSlide:0,callback:function(e,t){slideCount(),trackEvent({category:"Ad",event:"Carousel",GA:{label:"Click"}},["ga"]),$(".alert-verified-message").addClass("hide"),$(t).find("a").data("verified")?$(".js-alert-verified-gallery").removeClass("hide"):$(".js-alert-verified-gallery").addClass("hide")}}),slideCount()}function slideCount(){var e=window.mySwipe.getPos("Swipe")+1,t=window.mySwipe.getNumSlides("Swipe");e>t&&(e-=t),$("#slide-pos").html(e+" / "+t)}function setPopoverHandlers(){hideUnhideHandlersMobile(),$(".position-info").popover().off("show.bs.popover").on("show.bs.popover",(function(){$('<div class="modal-backdrop fade in"></div>').appendTo("body"),$(".modal-backdrop").on("click",(function(){$(".position-info").popover("hide")}))})).off("shown.bs.popover").on("shown.bs.popover",(function(){$(".item-position-alerts").html($("#item-position-info-subscribe-container").html())})).off("hide.bs.popover").on("hide.bs.popover",(function(){$(".modal-backdrop").off("click").remove()})),$(".ers_popover").each((function(){var e=$(this),t=e.attr("data-style")||"";e.popover({template:'<div class="popover '+t+'"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>'})})),$(".popover-auto-hide").off("click").click((function(){clearTimeout(e);var e=setTimeout((function(){$(".popover-auto-hide").popover("hide")}),3e3)})),$(".ers_popover").click((function(){$(window).width()>1024&&$(".ers_tooltip").tooltip("hide"),$(".ers_popover").not(this).popover("hide"),$(".btn-popover-no-cancel").unbind("click").bind("click",(function(){return $(".ers_popover").popover("hide"),!1}))}))}function bindMobileEvents(){$(".reset-filters").unbind("click").click((function(e){hideFiltersMobile(),resetFilters(),applyFilter(""),populateFormFilters(),changeUrl(),$(".js-initial-filters").show(),$(".js-filters-container").removeClass("filters__container--extended")})),$(".js-reset-filters").click((function(){hideFiltersMobile(),window.resetFilters(),$(".js-initial-filters").show(),$(".js-filters-container").removeClass("filters__container--extended")}))}function categoriesByParent(e){var t={};for(var i in categories)e&&categories[i].parent_id!=e||(t[i]=categories[i]);return t}$((function(){var e=$(".availabilities input:checkbox"),t=[];e.each((function(){var e=$(this);e.prop("checked")&&t.push(e.val())})),$("#availabilities").val(t),$(".item.page1 .toggle-history-popover").each((function(){var e=$(this),t=$(e.attr("data-content"));$(this).on("shown.bs.popover",(function(){1!=e.attr("data-loaded")&&$.ajax({url:e.attr("data-history-url"),success:function(i){var a="";if(i.success)for(var l=i.data,n=0;n<l.length;n++)a+='<p><span class="time">'+l[n].time+"</span>"+l[n].message+"</p>";e.attr("data-loaded",1),$(e.attr("data-container")).find(".history-content").html(a),t.find(".history-content").html(a),e.attr("data-content",t.prop("outerHTML"))}})}))})),$(".panel.active a.title").click((function(e){$(this).parent().hasClass("active")?(e.preventDefault(),$(this).parent().removeClass("active"),$(this).parent().find(".panel-body").addClass("hidden")):(e.preventDefault(),$(this).parent().addClass("active"),$(this).parent().find(".panel-body").removeClass("hidden"))})),$(".custom-select .val").click((function(){$(".custom-select .dropdown").removeClass("hidden")})),$(".custom-select .item-off").click((function(){$(".custom-select .dropdown").addClass("hidden")})),$("ul.dropdown-select li").click((function(e){$(this).siblings().removeClass("active"),$(this).addClass("active")})),$("#save-filters").click((function(e){e.preventDefault(),hideFiltersMobile(),$(".js-initial-filters").show(),$(".js-filters-container").removeClass("filters__container--extended");var t=$("#select-availability input:checkbox:checked").map((function(e){return $(this).val()})).get();applyFilter("availability",t,!0),applyFilter("age_from",parseInt($("#age_from").val()),!0),applyFilter("age_to",parseInt($("#age_to").val()),!0),$("#rate_from").length&&(applyFilter("rate_from",parseInt($("#rate_from").val()),!0),applyFilter("rate_to",parseInt($("#rate_to").val()),!0));var i=$("#select-service_code input:checkbox:checked").map((function(e){return $(this).val()})).get();applyFilter("service_id",i,!0);var a=$("#photoshoot").prop("checked")?1:"";applyFilter("photoshoot",a,!0);var l=$("#online").prop("checked")?1:"";applyFilter("online",l,!0);var n=$("#verified").prop("checked")?1:"";applyFilter("verified",n,!0);var r=$("#has_photos").prop("checked")?1:"";applyFilter("has_photos",r,!0);var s=$("#has_videos").prop("checked")?1:"";applyFilter("has_videos",s,!0);var o=$("#has_lyla").prop("checked")?1:"";applyFilter("has_lyla",o,!0),applyFilter("available_now",+$("#available-now").is(":checked"),!0),applyFilter("phone1",$("#inputCellNumber_01").val().trim(),!0),applyFilter("phone2",$("#inputCellNumber_02").val().trim(),!0),applyFilter("phone3",$("#inputCellNumber_03").val().trim(),!0),"1"===$("input[name='incall-range']:checked").val()?applyFilter("incall_dist",parseInt($("#incall_dist").val()),!0):applyFilter("incall_dist",""),applyMapFilters()||(applyFilter("page",1,!1,"replace"),scrollToElement("#view",100),changeUrl())})),$(".modal-save").on("click",(function(){var e=$("#"+$(this).attr("modal-for")+" input"),t=[];e.each((function(){$(this).prop("checked")&&0!=$(this).val()&&t.push($(this).val())})),"undefined"!=typeof directoryMode&&directoryMode?(applyDirectoryFilter($(this).attr("input_name"),t),changeDirectoryUrl()):(applyFilter($(this).attr("input_name"),t),changeUrl()),updateEthnicities(),updateEthnicities("#mobile-city_id","#cit")})),$("#select-ethnicity_id input").on("change",(function(){var e=$(this).next().text().trim();$(this).is(":checked")&&trackEvent({category:"Search",event:"Ethnicity",GA:{label:e}},["ga"])})),$("#mobile-city_id input").on("change",(function(){var e=$(this).next().text().trim();$(this).is(":checked")&&trackEvent({category:"Search",event:"City",GA:{label:e}},["ga"])})),$("#select-service_code input").on("change",(function(){var e=$(this).next().text().trim();$(this).is(":checked")&&trackEvent({category:"Search",event:"Online Services",GA:{label:e}},["ga"])})),$("#select-availability").unbind("change").change((function(e){e.preventDefault();var t=$("#select-availability input:checkbox:checked").map((function(e){return $(this).val()})).get();return t.includes("0")||t.includes("1")?($("#geo-filters").removeClass("hide"),!0):($("#geo-filters").addClass("hide"),!1)})),$("#select-province li").click((function(e){e.preventDefault(),provinceId=$(this).attr("select_value");var t=regionsByProvince[provinceId],i=$("#select_location_id");i.html("");var a="",l=!1;for(var n in t)l||(l=n),a+='<li select_value="'+n+'" name="region_id['+n+']" id="region_'+n+'"><a data-dismiss="modal" href="#">'+t[n].name+"</a></li>";(i.html(a),$("#current-province").text(provinces[provinceId]),l==n)&&($("#selected_region_name").text(t[l].name),trackEvent({category:"Search",event:"Region",GA:{label:$(this).find("a").text()}},["ga"]),("undefined"!=typeof applyDirectoryFilter?applyDirectoryFilter:applyFilter)("region_id",l));setDropdownHandlers(),setCities(l)}));var i=$(".js-listing-bam-category-item");$("#select-root li").click((function(e){e.preventDefault();var t=$(this).data("code");rootId=$(this).attr("select_value");var a=categoriesByParent(rootId),l=$("#select-category_id");l.html("");var n="";for(var r in a)n+='<li select_value="'+r+'"><a data-dismiss="modal" href="#">'+a[r].name+"</a></li>";i.length&&$(this).find(".red").length&&i.each((function(){n+=$(this)[0].outerHTML})),l.html(n),$("#selected_root").text(categories[rootId].name);$("#selected_root_icon").attr("class","icon icon-"+t),setDropdownHandlers()})),$("#page-settings").on("shown.bs.collapse",(function(e){$(e.target).prev(".panel-heading").addClass("active")})),$("#page-settings").on("hidden.bs.collapse",(function(e){$(e.target).prev(".panel-heading").removeClass("active")})),$(".remove_favourites").bind("click",(function(e){e.preventDefault();var t=$(this).attr("ad_id"),i=$(this).attr("user_id");(t>0||i>0)&&($.ajax({type:"POST",url:"/user/favourites",data:{remove_ad:t,remove_user:i},async:!0,success:function(e){},dataType:"html"}),$(".page_favorites").length>0&&$(this).parentsUntil(".lst").parent().hide(1e3,(function(){$(this).remove()})))})),$("#toggle-favourites").click((function(e){e.preventDefault();var t=$(this),i=$(this).attr("ad_id"),a=$(this).attr("user_id"),l={};t.hasClass("is-active")?(t.removeClass("is-active"),t.find(".text-unfav").hide(),t.find(".text-fav").show(),l={remove_ad:i,remove_user:a}):(t.addClass("is-active"),t.find(".text-fav").hide(),t.find(".text-unfav").show(),trackEvent({category:"Ad",event:"Favourite",GA:{label:"Click"}},["ga"]),l={add_ad:i,add_user:a}),(i>0||a>0)&&$.ajax({type:"POST",url:"/user/favourites",data:l,async:!0,success:function(e){},dataType:"html"})})),$(".view-page .recent-ads a").click((function(){trackEvent({category:"Ad",event:"Other Ad",GA:{label:"Click"}},["ga"])})),$(".completed-actions .show-actions").on("click",(function(e){e.preventDefault(),$(this).closest(".completed-actions").toggleClass("is-active")})),setPopoverHandlers(),$(".services").on("click",(function(){var e=($("#availabilities").val()||"").split(",");$(this).find("input:checkbox").each((function(){var t=$(this);t.prop("checked")&&t.parent().addClass("services-selected"),t.click((function(){t.prop("checked")?t.parent().addClass("services-selected"):t.parent().removeClass("services-selected")}));var i=[];if($(".services-selected").each((function(){i.push($(this).find("input:checkbox").val())})),i.length){$("#availability_3").prop("checked",!0),e.indexOf("3")<0&&e.push("3")}else{$("#availability_3").prop("checked",!1);var a=e.indexOf("3");a>-1&&e.splice(a,1)}$("#availabilities").val(e),$("#services").val(i)}))})),$("#more-filters, .services-banner").click((function(){$(".filter").addClass("hidden")})),$("#main_list").on("click",".services-banner",(function(){setTimeout((function(){scrollToElement("#service-filter",300)}),300)})),$("#form-search").submit((function(e){e.preventDefault()})),$("#desc").on("show.bs.collapse",(function(){$(".btn-collapse").remove(),$(".perex").hide()})),$("#mySwipe").length>0&&($(".swipe-wrap a").click((function(e){e.preventDefault(),$(this).blur()})),$(".swipe-wrap img").click((function(){window.mySwipe.next()}))),$("#js-showMessageAlert").on("click",(function(e){e.preventDefault(),$("#js-messageAlert").addClass("in")})),$("#js-messageAlert .btn").on("click",(function(e){e.preventDefault(),$("#js-messageAlert").removeClass("in")})),$(".bump10").on("shown.bs.popover",(function(){$(document).on("click",(function(e){$(e.target).closest(".bump10").length||$("#menucontainer").is(":visible")&&$(".bump10").popover("hide")}))}))}));